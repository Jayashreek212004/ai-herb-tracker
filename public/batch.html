<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Batch Details - Ayur Trace</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .card { border-radius:8px; padding:12px; margin:10px 0; box-shadow:0 1px 3px rgba(0,0,0,0.05); }
    .card:nth-child(odd) { background:#f0fdf4; }
    .card:nth-child(even) { background:#e0f2fe; }
    .backBtn { margin-bottom:10px; display:inline-block; background:#34d399; color:white; padding:6px 12px; border-radius:6px; text-decoration:none; }
  </style>
</head>
<body class="bg-green-50 text-gray-800">

<div class="max-w-4xl mx-auto p-6">

  <a href="index.html" class="backBtn">üè† Back to Home</a>

  <header class="mb-6">
    <h1 class="text-3xl font-bold text-green-700">üåø Batch Details</h1>
    <p class="text-gray-700 mt-1">Scan QR on the product to see its traceability journey.</p>
  </header>

  <div id="batchContent"></div>

</div>

<script>
async function fetchBatchDetails() {
  const params = new URLSearchParams(window.location.search);
  const batchId = params.get("batchId");
  const container = document.getElementById("batchContent");
  container.innerHTML = "";

  if(!batchId){
    container.innerHTML = `<p class="text-red-600">‚ö† Invalid QR code</p>`;
    return;
  }

  try {
    const res = await fetch("data/batches.json");
    if(!res.ok) throw new Error("Failed to fetch batches.json");
    const data = await res.json();
    const batch = data[batchId];
    if(!batch){
      container.innerHTML = `<p class="text-red-600">‚ö† No details found for ${batchId}</p>`;
      return;
    }

    const sections = [
      ["Batch ID", batchId],
      ["Farmer Name", batch.farmer.name],
      ["Farmer Location", batch.farmer.location],
      ["Agent", batch.agent.name + ", " + batch.agent.contact],
      ["Processor", batch.processor.company + ", " + batch.processor.location],
      ["Manufacturer", batch.manufacturer.company + ", " + batch.manufacturer.location]
    ];

    sections.forEach(([title, value])=>{
      const card = document.createElement("div");
      card.className = "card";
      card.innerHTML = `<h3 class="font-semibold mb-2 text-green-700">${title}</h3><p>${value}</p>`;
      container.appendChild(card);
    });

  } catch(err){
    container.innerHTML = `<p class="text-red-600">‚ö† Could not fetch batch details: ${err.message}</p>`;
  }
}

window.onload = fetchBatchDetails;
</script>

</body>
</html>
